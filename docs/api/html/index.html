<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>CSS: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CSS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CSS Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="d6/ded/namespaceCSS.html">CSS</a> (A <a class="el" href="d6/ded/namespaceCSS.html">CSS</a> parser and minifier written in PHP) </p>
<hr/>
<div class="image">
<img src="https://img.shields.io/badge/dynamic/json?label=current%20version&query=version&url=https%3A%2F%2Fraw.githubusercontent.com%2Ftbela99%2Fcss%2Fmaster%2Fcomposer.json"  alt="Current version"/>
</div>
<p> <a href="https://packagist.org/packages/tbela99/css">![Packagist](https://img.shields.io/packagist/v/tbela99/css.svg)</a> <a href="https://tbela99.github.io/css">![Documentation](https://img.shields.io/badge/dynamic/json?label=documentation&amp;query=version&amp;url=https%3A%2F%2Fraw.githubusercontent.com%2Ftbela99%2Fcss%2Fmaster%2Fcomposer.json)</a> <a href="https://snyk.io/test/github/tbela99/css">![Known Vulnerabilities](https://snyk.io/test/github/tbela99/gzip/badge.svg)</a></p>
<p>A <a class="el" href="d6/ded/namespaceCSS.html">CSS</a> parser, beautifier and minifier written in PHP. It supports the following features</p>
<h2>Features</h2>
<ul>
<li>fastly parse and render <a class="el" href="d6/ded/namespaceCSS.html">CSS</a></li>
<li>support CSS4 colors</li>
<li>merge duplicate rules</li>
<li>remove duplicate declarations</li>
<li>remove empty rules</li>
<li>process  directive</li>
<li>remove  directive</li>
<li>compute css shorthand (margin, padding, outline, border-radius, font)</li>
<li>query the css nodes using xpath like syntax or class name</li>
<li>transform the css output using the Renderer class</li>
</ul>
<h2>Installation</h2>
<p>install using <a href="https://getcomposer.org/">Composer</a></p>
<p>```bash $ composer require tbela99/css ```</p>
<h2>Requirements</h2>
<p>This library requires PHP version &gt;= 7.4. If you need support for older versions of PHP 5.6 - 7.3 then checkout <a href="https://github.com/tbela99/css/tree/php56-backport">this branch</a></p>
<h2>Usage:</h2>
<p>```css h1 { color: green; color: blue; color: black; }</p>
<p>h1 { color: #000; color: aliceblue; } ```</p>
<p>PHP Code</p>
<p>```php</p>
<p>use ;</p>
<p>$compiler = new Compiler();</p>
<p>$compiler-&gt;setContent(' h1 { color: green; color: blue; color: black; }</p>
<p>h1 { color: #000; color: aliceblue; }');</p>
<p>echo $compiler-&gt;compile(); ```</p>
<p>Result</p>
<p>```css h1 { color: #f0f8ff; } ```</p>
<p>Parse the css file and generate the AST</p>
<p>```php</p>
<p>use ; use ;</p>
<p>$parser = new Parser($css); $element = $parser-&gt;parse();</p>
<p>// append an existing css file $parser-&gt;append('<a href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css'">https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css'</a>);</p>
<p>// append css string $parser-&gt;appendContent($css_string);</p>
<p>// pretty print css $css = (string) $element;</p>
<p>// minified output $renderer = new Renderer([ 'compress' =&gt; true, 'convert_color' =&gt; 'hex', 'css_level' =&gt; 4, 'allow_duplicate_declarations' =&gt; false ]);</p>
<p>// fast $css = $renderer-&gt;renderAst($parser-&gt;getAst()); // slow $css = $renderer-&gt;render($element);</p>
<p>// save as json file_put_contents('style.json', json_encode($element)); ```</p>
<p>Load the AST and generate css code</p>
<p>```php</p>
<p>use ; // fastest way to render css $beautify = (new Renderer())-&gt;renderAst($parser-&gt;setContent($css)-&gt;getAst());</p>
<p>// or $css = (new Renderer())-&gt;renderAst(json_decode(file_get_contents('style.json'))); ```</p>
<p>```php</p>
<p>use ;</p>
<p>$ast = json_decode(file_get_contents('style.json'));</p>
<p>$compiler = new Compiler([ 'convert_color' =&gt; true, 'compress' =&gt; true, // minify the output 'remove_empty_nodes' =&gt; true // remove empty css classes ]);</p>
<p>$compiler-&gt;setData($ast);</p>
<p>$css = $compiler-&gt;compile(); ```</p>
<h2>The <a class="el" href="d6/ded/namespaceCSS.html">CSS</a> Query API</h2>
<p>Example: Extract Font-src declaration</p>
<p><a class="el" href="d6/ded/namespaceCSS.html">CSS</a> source</p>
<p>```css -face { font-family: "Bitstream Vera Serif Bold"; src: url("/static/styles/libs/font-awesome/fonts/fontawesome-webfont.fdf491ce5ff5.woff"); }</p>
<p>body { background-color: green; color: #fff; font-family: Arial, Helvetica, sans-serif; } h1 { color: #fff; font-size: 50px; font-family: Arial, Helvetica, sans-serif; font-weight: bold; }</p>
<p>print { -face { font-family: MaHelvetica; src: local("Helvetica Neue Bold"), local("HelveticaNeue-Bold"), url(MgOpenModernaBold.ttf); font-weight: bold; } body { font-family: "Bitstream Vera Serif Bold", serif; } p { font-size: 12px; color: #000; text-align: left; }</p>
<p>-face { font-family: Arial, MaHelvetica; src: local("Helvetica Neue Bold"), local("HelveticaNeue-Bold"), url(MgOpenModernaBold.ttf); font-weight: bold; } } ```</p>
<p>PHP source</p>
<p>```php</p>
<p>use ;</p>
<p>$compiler = new Compiler();</p>
<p>$compiler-&gt;setContent($css);</p>
<p>$stylesheet = $compiler-&gt;getData();</p>
<p>// get -face nodes by class names $nodes = $stylesheet-&gt;queryByClassNames('-face');</p>
<p>// or</p>
<p>// get all src properties in a -face rule $nodes = $stylesheet-&gt;query('-face/src');</p>
<p>echo implode("\n", array_map('trim', $nodes)); ```</p>
<p>result</p>
<p>```css -face { src: url("/static/styles/libs/font-awesome/fonts/fontawesome-webfont.fdf491ce5ff5.woff"); }  print { -face { src: local("Helvetica Neue Bold"), local("HelveticaNeue-Bold"), url(MgOpenModernaBold.ttf); } }  print { -face { src: local("Helvetica Neue Bold"), local("HelveticaNeue-Bold"), url(MgOpenModernaBold.ttf); } } ```</p>
<p>render optimized css</p>
<p>```php</p>
<p>$stylesheet-&gt;setChildren(array_map(function ($node) { return $node-&gt;copy()-&gt;getRoot(); }, $nodes));</p>
<p>$stylesheet-&gt;deduplicate();</p>
<p>echo $stylesheet; ```</p>
<p>result</p>
<p>```css -face { src: url(/static/styles/libs/font-awesome/fonts/fontawesome-webfont.fdf491ce5ff5.woff) }  print { -face { src: local("Helvetica Neue Bold"), local(HelveticaNeue-Bold), url(MgOpenModernaBold.ttf) } } ```</p>
<h2>Build a <a class="el" href="d6/ded/namespaceCSS.html">CSS</a> Document</h2>
<p>```php</p>
<p>use ;</p>
<p>$stylesheet = new Stylesheet();</p>
<p>$rule = $stylesheet-&gt;addRule('div');</p>
<p>$rule-&gt;addDeclaration('background-color', 'white'); $rule-&gt;addDeclaration('color', 'black');</p>
<p>echo $stylesheet;</p>
<p>```</p>
<p>output</p>
<p>```css div { background-color: #fff; color: #000; } ```</p>
<p>```php</p>
<p>$media = $stylesheet-&gt;addAtRule('media', 'print'); $media-&gt;append($rule);</p>
<p>```</p>
<p>output</p>
<p>```css  print { div { background-color: #fff; color: #000; } } ```</p>
<p>```php $div = $stylesheet-&gt;addRule('div');</p>
<p>$div-&gt;addDeclaration('max-width', '100'); $div-&gt;addDeclaration('border-width', '0px');</p>
<p>```</p>
<p>output</p>
<p>```css  print { div { background-color: #fff; color: #000; } } div { max-width: 100%; border-width: 0; } ```</p>
<p>```php</p>
<p>$media-&gt;append($div);</p>
<p>```</p>
<p>output</p>
<p>```css  print { div { background-color: #fff; color: #000; } div { max-width: 100%; border-width: 0; } } ```</p>
<p>```php</p>
<p>$stylesheet-&gt;insert($div, 0); ```</p>
<p>output</p>
<p>```css div { max-width: 100%; border-width: 0; }  print { div { background-color: #fff; color: #000; } } ``` Adding existing css ```php</p>
<p>$stylesheet-&gt;appendCss($css_string);</p>
<p>```</p>
<h2>Performance</h2>
<p>parsing and rendering ast is 3x faster than parsing an element</p>
<p>```php</p>
<p>use ; use ;</p>
<p>$parser = new Parser($css);</p>
<p>// parse and render echo (string) $parser;</p>
<p>// or render minified css $renderer = new Renderer(['compress' =&gt; true]); echo $renderer-&gt;renderAst($parser-&gt;getAst());</p>
<p>```</p>
<h2>Transform Rendered <a class="el" href="d6/ded/namespaceCSS.html">CSS</a></h2>
<p>Use the Renderer class to transform the output. the callback returns three types of values</p>
<ul>
<li>a Css node that will be rendered in place of the original node</li>
<li>a string that will be rendered in place of the original node</li>
<li>the constant Renderer::IGNORE_NODE, the node will not be rendered</li>
</ul>
<p>input Css</p>
<p>```css -face { font-family: "Bitstream Vera Serif Bold", "Arial", "Helvetica"; src: url("/static/styles/libs/font-awesome/fonts/fontawesome-webfont.fdf491ce5ff5.woff"); } .pic { background: no-repeat url("imgs/lizard.png"); } .element { background-image: url("imgs/lizard.png"), url("imgs/star.png"); } ```</p>
<p>PHP code</p>
<p>```php use <a class="el" href="d0/dce/namespaceTBela.html">TBela</a>; use ; use ; use ; use ; use ; use <a class="el" href="d0/dce/namespaceTBela.html">TBela</a>; use <a class="el" href="d0/dce/namespaceTBela.html">TBela</a>;</p>
<p>$element = (new Compiler())-&gt;setContent($css)-&gt;getData();</p>
<p>$renderer = new Renderer();</p>
<p>$renderer-&gt;on('enter', function (Renderable $node) { </p>
<pre class="fragment">// remove @font-face
if ($node instanceof AtRule &amp;&amp; $node['name'] == 'font-face') {

    return \TBela\CSS\Traverser::IGNORE_NODE;
}

// rewrite image url() path for local file
if ($node instanceof Declaration || $node instanceof Property) {

    if (strpos($node-&gt;getValue(), 'url(') !== false) {

        $node = clone $node;

        $node-&gt;getValue()-&gt;map(function (Value $value): Value {

            if ($value instanceof CssURL) {

                $value-&gt;arguments-&gt;map(function (Value $value): Value {

                    if (is_file($value-&gt;value)) {

                        return Value::getInstance((object) ['type' =&gt; $value-&gt;type, 'value' =&gt; '/'.$value-&gt;value]);
                    }

                    return $value;
                });
            }

            return $value;
        });
    }
}
</pre><p> });</p>
<p>echo $renderer-&gt;render($element); ```</p>
<p>Result</p>
<p>```css .pic { background: no-repeat url(/imgs/lizard.png); } .element { background-image: url(/imgs/lizard.png), url(/imgs/star.png); } ```</p>
<h2>Parser Options</h2>
<ul>
<li>flatten_import: process  directive and import the content into the css. default to false.</li>
<li>allow_duplicate_rules: allow duplicated rules. By default duplicate rules except -face are merged</li>
<li>allow_duplicate_declarations: allow duplicated declarations in the same rule.</li>
<li>sourcemap: include source location data</li>
</ul>
<h2>Compiler Options</h2>
<ul>
<li>charset: if false remove </li>
<li>glue: the line separator character. default to '<br/>
'</li>
<li>indent: character used to pad lines in css, default to a space character</li>
<li>remove_comments: remove comments. If <em>compress</em> is true, comments are always removed</li>
<li>convert_color: convert colors to a format between <em>hex</em>, <em>hsl</em>, <em>rgb</em>, <em>hwb</em> and <em>device-cmyk</em></li>
<li>css_level: will use CSS4 or CSS3 color format. default to <em>4</em></li>
<li>compress: produce minified output</li>
<li>remove_empty_nodes: remove empty css rules when the node is rendered</li>
</ul>
<p>The full <a href="https://tbela99.github.io/css">documentation</a> can be found <a href="https://tbela99.github.io/css">here</a> </p>
<hr/>
<p>Thanks to <a href="https://jetbrains.com">Jetbrains</a> for providing a free PhpStorm license</p>
<p>This was originally a PHP port of <a href="https://github.com/reworkcss/css">https://github.com/reworkcss/css</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
